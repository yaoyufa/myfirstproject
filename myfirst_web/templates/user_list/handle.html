{% load static from staticfiles %}
<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
	<title>天天生鲜-用户中心</title>
    <script type="text/javascript" src="{% static 'js/jquery-1.12.4.min.js' %}"></script>
	<link rel="stylesheet" type="text/css" href="{% static 'css/reset.css' %}">
	<link rel="stylesheet" type="text/css" href="{% static 'css/main.css' %}">
</head>
<body>
	<div class="header_con">
		<div class="header">
			<div class="welcome fl">欢迎来到天天生鲜!</div>
			<div class="fr">
                {% if user.is_authenticated %}
                    <div class="login_info fl">
                        欢迎您：<em>{{ user.username }}</em>
                    </div>
                {% else %}
                    <div class="login_btn fl">
                        <a href="{% url 'user:login' %}">登录</a>
                        <span>|</span>
                        <a href="{% url 'user:register' %}">注册</a>
                    </div>
                {% endif %}
				<div class="user_link fluser_address_county">
					<span>|</span>
					<a href="{% url 'user:user_center_info' %}">用户中心</a>
					<span>|</span>
					<a href="{% url 'cart:show_cart' %}">我的购物车</a>
					<span>|</span>
					<a href="{% url 'user:user_center_order' %}">我的订单</a>
				</div>
			</div>
		</div>
	</div>
	<div class="search_bar clearfix">
		<a href="{% url 'goods:index' %}" class="logo fl"><img src="{% static 'images/logo1.png' %}"></a>
		<div class="sub_page_name fl">|&nbsp;&nbsp;&nbsp;&nbsp;用户中心</div>
		<div class="search_con fr">
			<input type="text" class="input_text fl" name="" placeholder="搜索商品">
			<input type="button" class="input_btn fr" name="" value="搜索">
		</div>
	</div>

	<div class="main_con clearfix">
		<div class="left_menu_con clearfix">
			<h3>用户中心</h3>
			<ul>
				<li><a href="{% url 'user:user_center_info' %}">· 个人信息</a></li>
				<li><a href="{% url 'user:user_center_order' %}">· 全部订单</a></li>
				<li><a href="{% url 'user:user_center_site' %}" class="active">· 收货地址</a></li>
			</ul>
		</div>
		<div class="right_content clearfix">
				<h3 class="common_title2">编辑地址</h3>
				<div class="site_con">
					<form method="post" action="{% url 'user:handle' %}">
                        {% csrf_token %}
						<div class="form_group">
                            <input type="hidden" name="id" value="{{ user_id }}">
							<label>收件人：</label>
							<input type="text" value="{{ user_recipient }}" name="user_recipient">
						</div>
                        <div class="form_group form_group2">
							<label>详细地址：</label>
                            <select id="pro" name="province">
                                <option value="" >请选择省</option>
                            </select>
                            <select id="city" name="city">
                                <option value="" >请选择市</option>
                            </select>
                            <select id="county" name="county">
                                <option value="" >请选择区县</option>
                            </select>
							<textarea class="site_area" name="user_address">{{ user_address_detail }}</textarea>
						</div>
						<div class="form_group">
							<label>邮编：</label>
							<input type="text" value="{{ user_postcode }}" name="user_postcode">
						</div>
						<div class="form_group">
							<label>手机：</label>
							<input type="text" value="{{ user_phone }}" name="user_phone">
						</div>
						<input type="submit" name="" value="提交" class="info_submit">
					</form>
				</div>
		</div>
	</div>
	<div class="footer">
		<div class="foot_link">
			<a href="#">关于我们</a>
			<span>|</span>
			<a href="#">联系我们</a>
			<span>|</span>
			<a href="#">招聘人才</a>
			<span>|</span>
			<a href="#">友情链接</a>
		</div>
		<p>CopyRight © 2016 北京天天生鲜信息技术有限公司 All Rights Reserved</p>
		<p>电话：010-****888    京ICP备*******8号</p>
	</div>
</body>
<script>
        $(function () {
            //获取所有省份
            $.get('/user/province/', function (dic) {
                pro = $('#pro')
                $.each(dic.data, function (index, item) {
                    if ( item[1] == '{{ user_address_province }}' ){
                        pro.append('<option selected value=' + item[0] + '>' + item[1] + '</option>');
                    }else {
                        pro.append('<option value=' + item[0] + '>' + item[1] + '</option>');
                    }

                })
            })
            $.get('/user/city_'+'{{ user_address_province_id }}'+'/', function (dict) {
                city = $('#city')
                $.each(dict.data, function (index, item) {
                    console.info('item',item)
                    console.info('item2','{{ user_address_city }}')
                    if ( item[1] == '{{ user_address_city }}'){
                        city.append('<option selected value=' + item[0] + '>' + item[1] + '</option>');
                    }else {
                        city.append('<option value=' + item[0] + '>' + item[1] + '</option>');
                    }
                })
            })
           $.get('/user/county_'+'{{ user_address_city_id }}'+'/', function (dict) {
                county = $('#county')
                $.each(dict.data, function (index, item) {
                    console.info(item[1])
                    if ( item[1] == '{{ user_address_county }}' ){
                        county.append('<option selected value=' + item[0] + '>' + item[1] + '</option>');
                    }else {
                        county.append('<option value=' + item[0] + '>' + item[1] + '</option>');
                    }

                })
            })
            //获取市信息
            $('#pro').change(function () {
                $.get('/user/city_' + $(this).val() + '/', function (dict) {
                    city = $('#city');
                    city.empty().append('<option value="">请选择市</option>');
                    $('#county').empty().append('<option value="">请选择区县</option>');
                    $.each(dict.data, function (index, item) {
                        city.append('<option value=' + item[0] + '>' + item[1] + '</option>');
                    })
                });
            });
            //获取区县信息
            $('#city').change(function () {
                $.get('/user/county_' + $(this).val() + '/', function (dict) {
                    county = $('#county');
                    county.empty().append('<option value="">请选择区县</option>');
                    $.each(dict.data, function (index, item) {
                        county.append('<option value=' + item[0]+ '>' + item[1] + '</option>');
                    })
                })
            });
        })

    </script>
</html>